---
- name: Base
  hosts: all
  roles:
    - role: geerlingguy.repo-epel
      become: true
      when:
        - ansible_os_family == "RedHat"
        - ansible_distribution != "Fedora"
    - role: buluma.rpmfusion
      become: true
      when:
        - ansible_distribution == "Fedora"
    - system
    - editor
    - backups
    - containers
    - terminal
    - artis3n.tailscale.machine
    - firewall
    - notifications
- name: Server base
  hosts: servers
  roles:
    - reverse_proxy
- name: Guest base
  hosts: guests
  roles:
    - mounts
- name: Client base
  hosts: clients
  tasks:
    - name: Install packages
      ansible.builtin.import_tasks: common/tasks/install_packages.yml
      vars:
        packages:
          - bash-color-prompt
  roles:
    - credentials
    - automation
    - version_control
    - file_manager
    - feed_client
    - pim_client
    - email_client
- name: Physical box specific roles
  hosts: boxes
  roles:
    - hardware
    - disks
- name: Interactive box specific roles
  hosts: interactive_boxes
  roles:
    - file_sync
    - ide
  tasks:
    - name: Install packages
      ansible.builtin.import_tasks: common/tasks/install_packages.yml
      vars:
        packages:
          - firefox
    - name: Install flatpak packages
      ansible.builtin.import_tasks: common/tasks/install_flatpak_packages.yml
      vars:
        flatpaks:
          - md.obsidian.Obsidian
          - com.parsecgaming.parsec
          - net.ankiweb.Anki
          - com.discordapp.Discord
- name: Hypervisor specific roles
  hosts: hypervisors
  roles:
    - virtualization
    - admin_interface
- name: Nuc specific roles
  hosts: nuc
  tasks:
    - name: Mount internal drive
      become: true
      ansible.posix.mount:
        path: /mnt
        src: UUID=920c3284-0edc-485a-9fe8-7eb9b646a7f7
        fstype: auto
        opts: nofail
        state: mounted
  roles:
    - photos
    - file_sync
    - feed_reader
    - bookmarks
    - ebooks
    - audiobooks
    - version_control_server
    - ai_client
- name: Workstation specific roles
  hosts: workstation
  tasks:
    - name: Install packages
      ansible.builtin.import_tasks: common/tasks/install_packages.yml
      vars:
        packages:
          - intel-media-driver
- name: Recipe_vps specific roles
  hosts: recipe_vps
  roles:
    - recipes
    - ai_client
- name: Client_vps specific roles
  hosts: client_vps
  roles:
    - journal
